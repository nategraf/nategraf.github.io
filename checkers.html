<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8"> <![endif]-->  
<!--[if IE 9]> <html lang="en" class="ie9"> <![endif]-->  
<!--[if !IE]><!--> <html lang="en"> <!--<![endif]-->  
<head>
    <title>Checkers for One</title>
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Responsive HTML5 Website Landing Page for Developers">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">    
    <link rel="shortcut icon" href="favicon.ico">  
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400,300italic,400italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'> 
    <!-- Global CSS -->
    <link rel="stylesheet" href="assets/plugins/bootstrap/css/bootstrap.min.css">   
    <!-- Plugins CSS -->
    <link rel="stylesheet" href="assets/plugins/font-awesome/css/font-awesome.css">
    
    <!-- github calendar css -->
    <link rel="stylesheet" href="https://cdn.rawgit.com/IonicaBizau/github-calendar/gh-pages/dist/github-calendar.css"/>
    
    <!-- github acitivity css -->
    <link rel="stylesheet" href="assets/plugins/github-activity/github-activity-0.1.4.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/2.0.2/octicons.min.css">
    
    <!-- Jssor slider css -->
    <link rel="stylesheet" href="assets/css/checkers_slider.css">

    <!-- Theme CSS -->  
    <link id="theme-style" rel="stylesheet" href="assets/css/styles.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
</head> 

<body>
    <!-- BOID JS BACKGROUND -->
    <canvas id="boids" class="canvas-background" width="600" height="450"></canvas>

    <div class="row">
        <header class="header col-md-8 col-sm-8 col-xs-8 checkers-header-left">
            <h1 class="heading pull-right checkers-header-left-text"> Checkers for</h1>
        </header>
        <header class="header col-md-4 col-sm-4 col-xs-4 checkers-header-right">
            <h1 class="heading pull-left checkers-header-right-text"> &nbsp;One </h1>
        </header>
    </div><!--//row-->

    <div class="container sections-wrapper">
        <div class="primary col-md-12 col-sm-12 col-xs-12">

	    <section class="objective section">
                <div class="section-inner">
                    <h2 class="heading">Objective</h2>
                    <div class="content">
                        <p>Our objective is to build a computer enhanced checkers board which provides useful user feedback (e.g. move validation, turn timing, winning/losing notification) to the user when two players are playing, and allows a single player to play against an AI. </p>
                        <p>Checkers players of all ages. This board will provide trainging feedback to teach new players the game, and it will provide a challenging AI for veteran players to hone their skills against.</p>
                    </div>
                </div>
            </section>

            <section class="description section">
                <div class="section-inner">
                    <h2 class="heading">Project Description</h2>
                    <div class="content">
                        <p>Our goal is to create physical checkers board that provides three play modes for player. The game board will have led lights as a guide for the human user. When the human picks up one of their pieces, the possible squares they could move to will light up. This game can either be played by two players, or one player with the AI. When the AI has it's turn, it will light up the piece it wishes to move until the human player picks it up, and it will light up the square it wishes to move to until the player puts it there. The board will also be able to the current detect game state to recognise invalid moves and win conditions. The board will provide feedback to the user through the LED illuminated tiles. The board will provide two switches which can let users to chose which mode they want to play. Each switch will toggle whether that player is controled by the human or an AI.</p>
                        <p>We will detect the position of all of the pieces by embedding magnets in the bottom of the checker pieces and detecting the presence of a piece using a magnetic reed switch under each white square. These readinga will be fed into the multiplexers. There are total eight multiplexers connected to raspberry Pi, and each multiplexer will detect the piece positions on one row of the board. The system will know the game state by monitoring when a player picks up a piece and waiting for it to be placed on the board in a new position. If the picking up or placing of a piece ever violates the model of expected play, the board will light up in a way which indicated the error to the user and affords the opportunity to fix it.</p>
                        <p>There will be LED lights underneath each square of the board. The LED is controled by the SPI protocol, which will let the micro-computer light up each one with specific color. The LEDs will act as the display method for information and aesthetic elements. When the turn starts for a player all of the pieces which may be moved will be lit up by underneath LEDs. When the user picks up a piece, the possible moves will be lit. Once the user moves its piece, the AI will then calculate its move and will tell the user which piece the AI chose to move and where it wants it to be placed.  </p>
                        <p>The AI algorithm will determine the target position based on alpha beta pruning.</p>
                        <p>This box will contain all of the hardware components including the LEDs, sensors, Raspberry Pi computer, and power supply.The board has multiple layers. The first layer of the board will be a frosted glass with the black squares tinted darker. The second layer of the board will be the LED lights. The third layer is the 64 reed switches connected to the multiplexers. The container for the system will be attached to the planks containing reed switches.</p>


                        <!-- BEGIN SLIDER -->
                        <script type="text/javascript" src="assets/plugins/jquery-1.11.3.min.js"></script>
                        <script type="text/javascript" src="assets/plugins/jssor.slider.mini.js"></script>
                        <script type="text/javascript" src="assets/js/checkers_slider.js"></script>

                        <div id="jssor_1" style="position: relative; margin: 0 auto; top: 0px; width: 600px; height: 450px; left: 0px; overflow: hidden; visibility: hidden;">
                            <!-- Loading Screen -->
                            <div data-u="loading" style="position: absolute; top: 0px; left: 0px;">
                                <div style="filter: alpha(opacity=70); opacity: 0.7; position: absolute; display: block; top: 0px; left: 0px; width: 100%; height: 100%;"></div>
                                <div style="position:absolute;display:block;background:url('assets/images/checkers/slider/loading.gif') no-repeat center center;top:0px;left:0px;width:100%;height:100%;"></div>
                            </div>
                            <div data-u="slides" style="cursor: default; position: relative; top: 0px; left: 0px; width: 600px; height: 450px; overflow: hidden;">
                                <div data-p="112.50" style="display: none;">
                                    <img data-u="image" src="assets/images/checkers/slider/angled_complete.jpg" />
                                </div>
                                <div data-p="112.50" style="display: none;">
                                    <img data-u="image" src="assets/images/checkers/slider/top_complete.jpg" />
                                </div>
                                <div data-p="112.50" style="display: none;">
                                    <img data-u="image" src="assets/images/checkers/slider/led_plate.jpg" />
                                </div>
                                <div data-p="112.50" style="display: none;">
                                    <img data-u="image" src="assets/images/checkers/slider/reed_plate.jpg" />
                                </div>
                                <div data-p="112.50" style="display: none;">
                                    <img data-u="image" src="assets/images/checkers/slider/inside.jpg" />
                                </div>
                                <div data-p="112.50" style="display: none;">
                                    <img data-u="image" src="assets/images/checkers/slider/rasb_pi.jpg" />
                                </div>
                            </div>
                            <!-- Bullet Navigator -->
                            <div data-u="navigator" class="jssorb01" style="bottom:16px;right:16px;">
                                <div data-u="prototype" style="width:12px;height:12px;"></div>
                            </div>
                            <!-- Arrow Navigator -->
                            <span data-u="arrowleft" class="jssora02l" style="top:0px;left:8px;width:55px;height:55px;" data-autocenter="2"></span>
                            <span data-u="arrowright" class="jssora02r" style="top:0px;right:8px;width:55px;height:55px;" data-autocenter="2"></span>
                        </div>
                        <!-- END SLIDER -->
                    </div>
                </div>
            </section>

            <section class="tech-challenges section">
                <div class="section-inner">
                    <h2 class="heading">Technical Challenges</h2>
                    <div class="content">
                        <p>(1) Software:</p>
                        <ul>
                            <li>Tried to indicate when players made illegal moves, but the program isn't able to catch every error that a user might throw at it.</li>
                            <li>Because we used another's code as the backbones of the project, we had to make sure we knew how every one of their functions worked so that we could integrate our magnet sensing and led indicationg program.</li>
                            <li>The detection of if a piece can jump one piece vs jump more than one piece challenging.</li>
                        </ul>
                        <p>(2) Driver:</p>
                        <ul>
                            <li>The challenges are implementing the I2C and SPI protocol for the communication between hardware and software. In this part, you should be careful about the allocating the memory address and the byte of data sending to the device. Also, for the LED light part I need to convert all the unsigned byte to integer for the software to control the LED. In addition, it is also difficult to manipulate the receiving and sending bytes from SPI protocol. For the multiplexer part, I need to allocate the address precisely and calculate the expanding port based on the base address.  </li>
                        </ul>
                        <p>(3) Hardware:</p>
                        <ul>
                            <li>Designing the box to be manufacturable from cost effective materials proved to be challenging with the final solution being to make it out of 0.5" aspen plywood</li>
                            <li>Multiple modifications needed to be made to the box by hand after it was manufactured. These modifications were to fit the HDMI cable and two switches. I had to use a drill and files to carefully make the holes look clean</li>
                            <li>The magnetic reed switches are very fragile and we ended up braking multiple of them. We made sure to order extra and handle them carefully.</li>
                            <li>We ended up buying the wrong kind of multiplexers at first, and had to order a new set</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="hardware section">
                <div class="section-inner">
                    <h2 class="heading">Hardware Design</h2>
                    <div class="content">
                        <h3>Enclosure</h3>
                        <p>The box was all cut out of 0.5" Aspen plywood using the CNC Shopbot Mill in the Engineering Innovation Center. Nate create the CAD models for each part, which are displayed below</p>
                        <img class="img-responsive" src="assets/images/checkers/assembled_box.png" alt="Assembled Box"></img>
                        
                        <h3>LED Strips</h3>
                        <p>The internal circuitry for the LED strips is depicted below.</p>
                        <img class="img-responsive" src="assets/images/checkers/inner.png" alt="Inner LED Circuit"></img>

                        <h3>Multiplexers</h3>
                        <p>We use 8 multiplexers as I/O expender to read the status of reading switch by communicating through I2C protocol. Each MUX has 8 I/O pins which is used to read data. There are 3 address pins A0,A1,A2, which allow use to use at most 8 devices connected to the micocomputer. SDA and SCL are two pins used for I2C protoicol communication for operating every multiplexers.</p>
                        <div class="row">
                            <img class="col-md-6 col-sm-6 col-xs-12 img-responsive" src="assets/images/checkers/mux.png" alt="Mux Circuit View 1"></img>
                            <img class="col-md-6 col-sm-6 col-xs-12 img-responsive" src="assets/images/checkers/mux2.png" alt="Mux Circuit View 2"></img>
                        </div>

                        <h3>Top Level Schematic</h3>
                        <img class="img-responsive" src="assets/images/checkers/checkers_schematic.png" alt="Top Level Schematic"></img>
                    </div>
                </div>
            </section>

            <section class="software section">
                <div class="section-inner">
                    <h2 class="heading">Software Design</h2>
                    <div class="content">
                        <h3>I2C Interface Programing</h3>
                        <p>Setting up</p>
                        <ol>
                            <li>Send a start sequence:</li>
                            <li>Send the I2C address of the slave with the R/W bit low (even address)</li>
                            <li>Send the internal register number you want to write to</li>
                            <li>Send the data byte</li>
                            <li>[Optionally, send any further data bytes]</li>
                            <li>Send the stop sequence.</li>
                        </ol>
                        <p>Reading from a device:</p>
                        <ol>
                            <li>Send a start sequence</li>
                            <li>Send 0xE0 ( I2C address of the SRF08 with the R/W bit low (even address)</li>
                            <li>Send 0x00 (Internal address of the command register)</li>
                            <li>Send 0x51 (The command to start the SRF08 ranging)</li>
                            <li>Send the stop sequence.</li>
                        </ol>
                        <img class="img-responsive" src="assets/images/checkers/i2c.png" alt="I2C"></img>

                        <h3>SPI Interface Programming</h3>
                        <p>In SPI, only one side generates the clock signal (usually called CLK or SCK for Serial ClocK). The side that generates the clock is called the “master”, and the other side is called the “slave”. There is always only one master (which is almost always the microcontroller), but there can be multiple slaves (more on this in a bit). When data is sent from the master to a slave, it’s sent on a data line called MOSI, for “Master Out / Slave In”.</p>
                        <img class="img-responsive" src="assets/images/checkers/spi.png" alt="SPI"></img>

                        <h3>Driver</h3>
                        <p>The driver can take the reed switches states and puts the states in a 2D integer array. The driver takes in a 2D array of RGB values and displays those colors onto the physical board. The LED is implemented by SPI. First, i need to use file descriptor to open SPI device, then allocate enough memeory according to the number of LED. For lighting those up, i first should convert the int to unsigned byte and then send the bytes to the device. For multiplexier, i need to allocate memory address for all the eight MUXs, then set up each reading port by assign the address according to the base address.</p>

                        <h3>Game</h3>
                        <p>We used <a href="https://github.com/harrisonzhao/checkers-ai-cpp">Harrison Zhao's Checkers C++</a> code to get a list of possible moves the pieces can make. It also includes an AI component, allowing for human vs human, computer vs human, and computer vs computer. We took our driver class that keeps track of where the pieces are on the board, the checkerboard code that we created to light the board at certain times and combined everything together.</p>
                        <p>The program keeps track of the pieces movement using two 2D arrays. During a player's turn, the program will first light up all the possible moves that the user can make. The program will take the current checker pieces into a 2D array and subtract it from the previous board's state. If the resulting 2D array has a 1, it means that the piece was picked up, if the array includes a -1, it means that the piece was placed down. If a player is holding the piece, the board will show a 1 but not a -1, and will display the possible moves that the player can make with that individual piece. Once a player puts the piece down, the program will determine if the move the player made is valid, if so then then the player's turn ends. If the move is invalid, the board will indicate what the player did wrong and will wait until the player makes a valid move to change it to the other player. </p>
                        <p>There are colors that we have used to define certain moves/actions:</p>
                        <ul>
                            <li>Blue - the piece occupying the space can make a valid move.</li>
                            <li>Green - highlights a square that a piece can move to</li>
                            <li>Red - a piece is in an invalid state (either picked up a piece that isn't playable that turn, put down a piece in an invalid space, or the captured piece(s) need to be taken off the board)</li>
                            <li>Yellow - indicates the path that a double jump/triple/quadruple jump takes</li>
                            <li>White - at the start of the game, if the pieces aren't put down</li>
                        </ul>
                    </div>
                </div>
            </section>

            <section class="video section">
                <div class="section-inner">
                    <h2 class="heading">Video Demo</h2>
                    <div class="content">
                        <div class="video-wrapper">
                            <iframe src="https://www.youtube.com/embed/3Wm2tg46zpE" frameborder="0" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>
    <script type="text/javascript" src="assets/js/boid.js"></script>  
</body>
</html>
